---
---

<nav
  class="flex items-center justify-between py-8 px-12 bg-gray-50 dark:bg-gray-900 fixed top-0 left-0 w-full z-51 border-b border-transparent dark:border-gray-800 transition-colors duration-500 ease-in-out"
>
  <div class="flex gap-10">
    <a
      href="#home"
      class="nav-link font-heading uppercase text-[13px] font-bold text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 tracking-wide border-b-2 border-transparent pb-0.5 mt-0.5"
    >
      Home
    </a>
    <a
      href="#projects"
      class="nav-link font-heading uppercase text-[13px] font-bold text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 tracking-wide border-b-2 border-transparent pb-0.5 mt-0.5"
    >
      Projects
    </a>
    <a
      href="#contact"
      class="nav-link font-heading uppercase text-[13px] font-bold text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 tracking-wide border-b-2 border-transparent pb-0.5 mt-0.5"
    >
      Contact
    </a>
  </div>

  <div class="flex items-center gap-6">
    <button
      id="theme-toggle"
      class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 cursor-pointer group flex items-center justify-center p-1"
      aria-label="Toggle Theme"
    >
      {/* Light Mode Icon (Sun) - hidden when dark */}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6 transition-all duration-500 block dark:hidden group-hover:rotate-45"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="1.5"
      >
        <circle cx="12" cy="12" r="4"></circle>
        <path d="M12 2v2"></path>
        <path d="M12 20v2"></path>
        <path d="m4.93 4.93 1.41 1.41"></path>
        <path d="m17.66 17.66 1.41 1.41"></path>
        <path d="M2 12h2"></path>
        <path d="M20 12h2"></path>
        <path d="m6.34 17.66-1.41 1.41"></path>
        <path d="m19.07 4.93-1.41 1.41"></path>
      </svg>
      {/* Dark Mode Icon (Moon) - shown only when dark */}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6 transition-all duration-500 hidden dark:block group-hover:-rotate-12"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="1.5"
      >
        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
      </svg>
    </button>

    <div class="text-right leading-[0.8] tracking-tighter">
      <div class="font-heading font-[800] text-[34px] text-blue-600 uppercase">
        Guilherme
      </div>
      <div class="font-heading font-[800] text-[34px] text-blue-600 uppercase">
        Cantarino
      </div>
    </div>
  </div>
</nav>

<script>
  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");

    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
  };

  document
    .getElementById("theme-toggle")
    ?.addEventListener("click", handleToggleClick);

  // Scroll Spy Logic
  function setupScrollSpy() {
    const sections = document.querySelectorAll("section[id]");
    const navLinks = document.querySelectorAll(".nav-link");

    const options = {
      threshold: 0.1, // Trigger as soon as 10% is visible in the margin area
      rootMargin: "-45% 0px -45% 0px", // Detect sections crossing the middle of the screen
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const id = entry.target.getAttribute("id");

          navLinks.forEach((link) => {
            const href = link.getAttribute("href");
            if (href === `#${id}`) {
              link.classList.add("text-blue-600", "border-blue-600");
              link.classList.remove(
                "text-gray-900",
                "dark:text-gray-100",
                "border-transparent"
              );
            } else {
              link.classList.remove("text-blue-600", "border-blue-600");
              link.classList.add(
                "text-gray-900",
                "dark:text-gray-100",
                "border-transparent"
              );
            }
          });
        }
      });
    }, options);

    sections.forEach((section) => observer.observe(section));
  }

  // Run on initial load and view transitions
  setupScrollSpy();
  document.addEventListener("astro:page-load", setupScrollSpy);
</script>
