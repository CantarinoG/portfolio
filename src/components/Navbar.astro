---
---

<nav
  class="flex items-center justify-between py-6 md:py-8 px-6 md:px-12 bg-gray-50 dark:bg-gray-900 fixed top-0 left-0 w-full z-51 border-b border-transparent dark:border-gray-800 transition-colors duration-500 ease-in-out"
>
  <!-- Desktop Navigation -->
  <div class="hidden md:flex gap-10">
    {
      ["Home", "Projects", "Contact"].map((item) => (
        <a
          href={`#${item.toLowerCase()}`}
          class="nav-link font-heading uppercase text-[13px] font-bold text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 tracking-wide border-b-2 border-transparent pb-0.5 mt-0.5 focus:outline-none focus:ring-2 focus:ring-blue-600 "
        >
          {item}
        </a>
      ))
    }
  </div>

  <!-- Mobile Menu Button -->
  <div class="flex md:hidden">
    <button
      id="mobile-menu-toggle"
      class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 focus:outline-none z-[60] relative w-8 h-8 group"
      aria-label="Toggle Mobile Menu"
    >
      <div
        class="absolute inset-0 flex flex-col items-center justify-center gap-1.5"
      >
        <span
          class="w-8 h-0.5 bg-current transition-all duration-300 origin-center group-[.is-open]:rotate-45 group-[.is-open]:translate-y-2"
        ></span>
        <span
          class="w-8 h-0.5 bg-current transition-all duration-300 group-[.is-open]:opacity-0"
        ></span>
        <span
          class="w-8 h-0.5 bg-current transition-all duration-300 origin-center group-[.is-open]:-rotate-45 group-[.is-open]:-translate-y-2"
        ></span>
      </div>
    </button>
  </div>

  <div class="flex items-center gap-4 md:gap-6">
    <button
      id="theme-toggle"
      class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 cursor-pointer group flex items-center justify-center p-1 focus:outline-none focus:ring-2 focus:ring-blue-600 rounded-full"
      aria-label="Toggle Theme"
    >
      <!-- Sun Icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6 transition-all duration-500 block dark:hidden group-hover:rotate-45"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="1.5"
      >
        <circle cx="12" cy="12" r="4"></circle>
        <path d="M12 2v2"></path>
        <path d="M12 20v2"></path>
        <path d="m4.93 4.93 1.41 1.41"></path>
        <path d="m17.66 17.66 1.41 1.41"></path>
        <path d="M2 12h2"></path>
        <path d="M20 12h2"></path>
        <path d="m6.34 17.66-1.41 1.41"></path>
        <path d="m19.07 4.93-1.41 1.41"></path>
      </svg>
      <!-- Moon Icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6 transition-all duration-500 hidden dark:block group-hover:-rotate-12"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="1.5"
      >
        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
      </svg>
    </button>

    <div class="text-right leading-[0.8] tracking-tighter">
      <div
        class="font-heading font-[800] text-[24px] md:text-[34px] text-blue-600 uppercase"
      >
        Guilherme
      </div>
      <div
        class="font-heading font-[800] text-[24px] md:text-[34px] text-blue-600 uppercase"
      >
        Cantarino
      </div>
    </div>
  </div>
</nav>

<!-- Mobile Menu Drawer -->
<div
  id="mobile-drawer"
  class="fixed inset-0 z-50 bg-gray-50 dark:bg-gray-900 transform translate-x-full transition-transform duration-300 ease-in-out md:hidden"
>
  <div class="flex flex-col h-full p-8 pt-24 gap-8">
    <button
      id="mobile-drawer-close"
      class="absolute top-6 left-6 text-gray-900 dark:text-gray-100 hover:text-blue-600 focus:outline-none"
      aria-label="Close Mobile Menu"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-10 h-10"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
    {
      ["Home", "Projects", "Contact"].map((item) => (
        <a
          href={`#${item.toLowerCase()}`}
          class="mobile-nav-link font-heading uppercase text-3xl font-black text-gray-900 dark:text-gray-100 hover:text-blue-600 transition-colors"
        >
          {item}
        </a>
      ))
    }
  </div>
</div>

<script>
  // Theme Toggle
  const setupThemeToggle = () => {
    const handleToggleClick = () => {
      const element = document.documentElement;
      element.classList.toggle("dark");
      const isDark = element.classList.contains("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
    };

    document
      .getElementById("theme-toggle")
      ?.addEventListener("click", handleToggleClick);
  };

  // Mobile Menu
  const setupMobileMenu = () => {
    const toggle = document.getElementById("mobile-menu-toggle");
    const close = document.getElementById("mobile-drawer-close");
    const drawer = document.getElementById("mobile-drawer");
    const links = document.querySelectorAll(".mobile-nav-link");

    const toggleDrawer = () => {
      const isOpen = !drawer?.classList.contains("translate-x-full");

      if (isOpen) {
        closeDrawer();
      } else {
        openDrawer();
      }
    };

    const openDrawer = () => {
      drawer?.classList.remove("translate-x-full");
      toggle?.classList.add("is-open");
      document.body.style.overflow = "hidden";
    };

    const closeDrawer = () => {
      drawer?.classList.add("translate-x-full");
      toggle?.classList.remove("is-open");
      document.body.style.overflow = "";
    };

    toggle?.addEventListener("click", toggleDrawer);
    close?.addEventListener("click", closeDrawer);
    links.forEach((link) => link.addEventListener("click", closeDrawer));
  };

  // Scroll Spy Logic
  function setupScrollSpy() {
    const sections = document.querySelectorAll("section[id]");
    const navLinks = document.querySelectorAll(".nav-link, .mobile-nav-link");

    const options = {
      threshold: 0.1,
      rootMargin: "-45% 0px -45% 0px",
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const id = entry.target.getAttribute("id");

          navLinks.forEach((link) => {
            const isActive = link.getAttribute("href") === `#${id}`;
            const isMobile = link.classList.contains("mobile-nav-link");

            link.classList.toggle("text-blue-600", isActive);
            link.classList.toggle("text-gray-900", !isActive);
            link.classList.toggle("dark:text-gray-100", !isActive);

            if (!isMobile) {
              link.classList.toggle("border-blue-600", isActive);
              link.classList.toggle("border-transparent", !isActive);
            }
          });
        }
      });
    }, options);

    sections.forEach((section) => observer.observe(section));
  }

  const init = () => {
    setupThemeToggle();
    setupMobileMenu();
    setupScrollSpy();
  };

  init();
  document.addEventListener("astro:page-load", init);
</script>
